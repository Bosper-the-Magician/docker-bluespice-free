<VirtualHost *:80>

        <FilesMatch \.php$>
                SetHandler "proxy:unix:/var/run/php/php8.0-fpm.sock|fcgi://localhost/"
        </FilesMatch>

        RewriteEngine On
        RewriteRule ^/?webdav/(.*?)$ %{DOCUMENT_ROOT}/w/webdav.php/$1 [L]
        RewriteRule ^/*$ %{DOCUMENT_ROOT}/w/index.php [L]
        RewriteRule ^/?wiki(/.*)?$ %{DOCUMENT_ROOT}/w/index.php [L]

        # Required for PHP/Parsoid to avoid subpage creation issue
        AllowEncodedSlashes NoDecode
        # / Required for PHP/Parsoid to avoid subpage creation issue

        DocumentRoot /data/codebase

        <Directory /data/codebase>
                Options FollowSymLinks MultiViews
                AllowOverride None
                Require all granted
        </Directory>

        <Directory /data/codebase/w/_sf_archive>
                Require all denied
        </Directory>

        <Directory /data/codebase/w/_sf_instances>
                Require all denied
        </Directory>

        <Directory /data/codebase/w/cache>
                Require all denied
        </Directory>

        <Directory /data/codebase/w/images>
                AllowOverride None
                AddType text/plain .html .htm .shtml .phtml .php .php3 .php4 .php5 .php7
                Require all denied
        </Directory>

        <DirectoryMatch .git>
                Require all denied
        </DirectoryMatch>

        ErrorLog /data/logs/apache-error.log
        LogLevel warn
        CustomLog /data/logs/apache-access.log combined
        ServerSignature Off

</VirtualHost>